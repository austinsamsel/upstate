define("parsley/form",["parsley/abstract","parsley/utils"],function(i,t){var s=function(i,s){if(this.__class__="ParsleyForm",this.__id__=t.hash(4),"OptionsFactory"!==t.get(s,"__class__"))throw new Error("You must give an OptionsFactory instance");this.OptionsFactory=s,this.$element=$(i),this.validationResult=null,this.options=this.OptionsFactory.get(this)};return s.prototype={onSubmitValidate:function(i){return this.validate(void 0,void 0,i),!1===this.validationResult&&i instanceof $.Event&&(i.stopImmediatePropagation(),i.preventDefault()),this},validate:function(i,t,s){this.submitEvent=s,this.validationResult=!0;var e=[];$.emit("parsley:form:validate",this),this._refreshFields();for(var n=0;n<this.fields.length;n++)(!i||this._isFieldInGroup(this.fields[n],i))&&(e=this.fields[n].validate(t),!0!==e&&e.length>0&&this.validationResult&&(this.validationResult=!1));return $.emit("parsley:form:"+(this.validationResult?"success":"error"),this),$.emit("parsley:form:validated",this),this.validationResult},isValid:function(i,t){this._refreshFields();for(var s=0;s<this.fields.length;s++)if((!i||this._isFieldInGroup(this.fields[s],i))&&!1===this.fields[s].isValid(t))return!1;return!0},_isFieldInGroup:function(i,s){return t.isArray(i.options.group)?-1!==$.inArray(s,i.options.group):i.options.group===s},_refreshFields:function(){return this.actualizeOptions()._bindFields()},_bindFields:function(){var i=this;return this.fields=[],this.fieldsMappedById={},this.$element.find(this.options.inputs).each(function(){var t=new window.Parsley(this,{},i);"ParsleyField"!==t.__class__&&"ParsleyFieldMultiple"!==t.__class__||t.$element.is(t.options.excluded)||"undefined"==typeof i.fieldsMappedById[t.__class__+"-"+t.__id__]&&(i.fieldsMappedById[t.__class__+"-"+t.__id__]=t,i.fields.push(t))}),this}},s});